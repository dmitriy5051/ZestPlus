image: ubuntu:xenial
.job_8.1:
  script: &build_script
    - apt-get update -qyy
    - apt-get install -qyy curl bc make git build-essential
    - apt-get --yes install libglib2.0-dev curl flex g++-multilib gcc-multilib gnupg gperf lib32ncurses5-dev lib32z1-dev libesd0-dev libncurses5-dev libsdl1.2-dev libwxgtk-media3.0-dev libxml2 libxml2-utils lzop pngcrush schedtool squashfs-tools xsltproc zip zlib1g-dev
    - git clone https://github.com/assusdan/arm-cortex-linux-gnueabi-linaro_5.2
    - export KBUILD_BUILD_USER=sunk851
    - export KBUILD_BUILD_HOST=4pda
    - export PATH=$PATH:$PWD/arm-cortex-linux-gnueabi-linaro_5.2/bin/ 
    - export ARCH=arm
    - export SUBARCH=arm
    - export CROSS_COMPILE=$PWD/arm-cortex-linux-gnueabi-linaro_5.2/bin/arm-cortex-linux-gnueabi-
    - make X5PRO_6735m_defconfig
    - make
    - curl --upload-file builds.log https://transfer.sh/builds.log |grep transfer
    - curl --upload-file errors.log https://transfer.sh/errors.log |grep transfer
    - curl --upload-file arch/arm/boot/zImage-dtb https://transfer.sh/zImage-dtb |grep transfer
job_8.1:
  stage: test
  tags:
    - gitlab-org
  script: *build_script